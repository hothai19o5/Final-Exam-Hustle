(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{510:(e,t,s)=>{"use strict";s.d(t,{default:()=>z});var a=s(5155),r=s(2115),l=s(3925),n=s(8864),i=s(1982),d=s(9708),o=s(2085),c=s(9434);let u=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),m=r.forwardRef((e,t)=>{let{className:s,variant:r,size:l,asChild:n=!1,...i}=e,o=n?d.DX:"button";return(0,a.jsx)(o,{className:(0,c.cn)(u({variant:r,size:l,className:s})),ref:t,...i})});m.displayName="Button";let x=r.forwardRef((e,t)=>{let{className:s,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,c.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...l})});x.displayName="Input";var f=s(968);let h=(0,o.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(f.b,{ref:t,className:(0,c.cn)(h(),s),...r})});p.displayName=f.b.displayName;let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});g.displayName="Card";let y=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("flex flex-col space-y-1.5 p-6",s),...r})});y.displayName="CardHeader";let N=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});N.displayName="CardTitle";let v=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",s),...r})});v.displayName="CardDescription";let j=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("p-6 pt-0",s),...r})});j.displayName="CardContent",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,c.cn)("flex items-center p-6 pt-0",s),...r})}).displayName="CardFooter";let b=(0,o.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function w(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,c.cn)(b({variant:s}),t),...r})}var S=s(5318),A=s(1550),E=s(8328),T=s(7648),D=s(4558),C=s(286),_=s(9239),k=s(3662),F=s(4386);function M(e){let{exam:t,onDelete:s}=e,[l,n]=(0,r.useState)(0);return(0,r.useEffect)(()=>{let e;let s=()=>{if(t.examDate)try{let e=(0,i.qg)(t.examDate,"dd.MM.yyyy",new Date),s=new Date;s.setHours(0,0,0,0);let a=(0,F.c)(e,s);n(a>=0?a:0)}catch(e){console.error("Error parsing date in ExamCard:",t.examDate,e),n(0)}else n(0)};return s(),e=setInterval(s,864e5),()=>clearInterval(e)},[t.examDate]),(0,a.jsxs)(g,{className:"w-full shadow-lg hover:shadow-xl transition-shadow duration-300 relative",children:[(0,a.jsx)(m,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-7 w-7 text-muted-foreground hover:text-destructive",onClick:()=>s(t.id),"aria-label":"Delete exam",children:(0,a.jsx)(S.A,{className:"h-5 w-5"})}),(0,a.jsxs)(y,{children:[(0,a.jsxs)(N,{className:"flex items-center text-xl font-semibold pr-8",children:[(0,a.jsx)(A.A,{className:"mr-3 h-6 w-6 text-primary"}),t.courseName]}),(0,a.jsxs)(v,{className:"flex items-center text-sm",children:[(0,a.jsx)(E.A,{className:"mr-2 h-4 w-4 text-muted-foreground"}),"Ng\xe0y thi: ",t.examDate]})]}),(0,a.jsxs)(j,{children:[(0,a.jsxs)("div",{className:"flex items-center justify-start space-x-2",children:[(0,a.jsx)(T.A,{className:"h-8 w-8 text-accent"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-3xl font-bold text-accent",children:l}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"c\xf2n lại"})]})]}),0===l&&(0,a.jsx)(w,{variant:"destructive",className:"mt-4",children:"H\xf4m nay thi rồi shop!"}),l>0&&l<=7&&(0,a.jsx)(w,{variant:"secondary",className:"mt-4",children:"Tới đ\xedt rồi \xe1!"}),(0,a.jsxs)("div",{className:"mt-6 pt-4 border-t border-border/50",children:[(0,a.jsx)("h4",{className:"text-md font-medium mb-3 text-foreground/80",children:"Chi tiết:"}),(0,a.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4 text-primary shrink-0"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"M\xe3 lớp: "}),(0,a.jsx)("span",{className:"font-medium text-foreground/90 ml-1",children:t.classCode})]}),(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)(D.A,{className:"mr-2 h-4 w-4 text-primary shrink-0"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"M\xe3 lớp thi: "}),(0,a.jsx)("span",{className:"font-medium text-foreground/90 ml-1",children:t.examCode})]}),t.group&&"N/A"!==t.group&&(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)(C.A,{className:"mr-2 h-4 w-4 text-primary shrink-0"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Nh\xf3m: "}),(0,a.jsx)("span",{className:"font-medium text-foreground/90 ml-1",children:t.group})]}),t.examTeam&&"N/A"!==t.examTeam&&(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)(_.A,{className:"mr-2 h-4 w-4 text-primary shrink-0"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"K\xedp thi: "}),(0,a.jsx)("span",{className:"font-medium text-foreground/90 ml-1",children:t.examTeam})]}),t.examRoom&&"N/A"!==t.examRoom&&(0,a.jsxs)("li",{className:"flex items-center",children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4 text-primary shrink-0"}),(0,a.jsx)("span",{className:"text-muted-foreground",children:"Ph\xf2ng thi: "}),(0,a.jsx)("span",{className:"font-medium text-foreground/90 ml-1",children:t.examRoom})]})]})]})]})]})}var R=s(7481),I=s(7607),O=s(5300),P=s(5727),U=s(172),L=s(1133),V=s(960),W=s(594);function z(){let[e,t]=(0,r.useState)(null),[s,d]=(0,r.useState)(""),[o,c]=(0,r.useState)([]),[u,f]=(0,r.useState)(!1),[h,b]=(0,r.useState)(null),{toast:w}=(0,R.dj)(),[S,A]=(0,r.useState)(null),[E,T]=(0,r.useState)(null),[D,C]=(0,r.useState)(!0),_=(e,t)=>{let s=l.LF(e,{type:"array",cellDates:!0}),a=s.SheetNames[0],r=s.Sheets[a],i=l.Wp.sheet_to_json(r),d=[];return i.forEach((e,s)=>{let a=e["M\xe3 lớp"],r=e["T\xean học phần"],l=e["Ng\xe0y thi"],i=e["Nh\xf3m"],o=e["K\xedp thi"],c=e["Ph\xf2ng thi"],u=e["M\xe3 lớp thi"],m=null==a?void 0:a.toString().trim().toLowerCase(),x=null==u?void 0:u.toString().trim().toLowerCase(),f=null==r?void 0:r.toString().trim(),h="";if(l instanceof Date)h=(0,n.GP)(l,"dd.MM.yyyy");else if("string"==typeof l){let e=l.trim();if(/^\d{1,2}[\.\/-]\d{1,2}[\.\/-]\d{4}$/.test(e)){let t=e.replace(/\//g,".").split("."),s=t[0].padStart(2,"0"),a=t[1].padStart(2,"0"),r=t[2];h="".concat(s,".").concat(a,".").concat(r)}else if(/^\d{1,2}[\.\/-]\d{1,2}[\.\/-]\d{2}$/.test(e)){let t=e.replace(/\//g,".").split("."),s=t[0].padStart(2,"0"),a=t[1].padStart(2,"0"),r="20"+t[2];h="".concat(s,".").concat(a,".").concat(r)}/^\d{2}\.\d{2}\.\d{4}$/.test(h)||(h="")}let p=(null==i?void 0:i.toString().trim())||"N/A",g=(null==o?void 0:o.toString().trim())||"N/A",y=(null==c?void 0:c.toString().trim())||"N/A";m&&f&&h&&d.push({id:"".concat(m,"-").concat(f,"-").concat(h,"-").concat(p,"-").concat(g,"-").concat(y,"-").concat(x,"-").concat(t,"-").concat(s),classCode:m,courseName:f,examDate:h,group:p,examTeam:g,examRoom:y,examCode:x})}),d};(0,r.useEffect)(()=>{(async()=>{C(!0);try{let e=await fetch("/default_schedule.xlsx");if(!e.ok)throw Error("Default schedule not found or failed to load.");let t=await e.arrayBuffer(),s=_(t,"default_schedule.xlsx");A(s),T("default"),b(null),w({title:"Default Schedule Loaded",description:"You can now search class codes in the default schedule or upload your own."})}catch(e){console.warn("Failed to load default schedule:",e.message),T(null)}finally{C(!1)}})()},[]);let k=async e=>{if(e.target.files&&e.target.files[0]){let s=e.target.files[0];if(!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv","application/vnd.ms-excel"].includes(s.type)&&!s.name.endsWith(".csv")&&!s.name.endsWith(".xlsx")&&!s.name.endsWith(".xls")){w({variant:"destructive",title:"Invalid File Type",description:"Please upload an Excel (.xlsx, .xls) or CSV (.csv) file."}),t(null),e.target&&(e.target.value="");return}t(s),f(!0),b(null);try{let e=new FileReader;e.onload=e=>{var t;if(null===(t=e.target)||void 0===t?void 0:t.result){let t=_(e.target.result,s.name);A(t),T("user"),c([]),w({title:"File Loaded",description:'Successfully parsed "'.concat(s.name,'". Enter class codes to search.')})}else throw Error("Failed to read file data.");f(!1)},e.onerror=()=>{b("Failed to read the uploaded file: ".concat(s.name,".")),w({variant:"destructive",title:"File Read Error",description:"Could not read the file."}),f(!1),T(null),A(null)},e.readAsArrayBuffer(s)}catch(e){b('Failed to parse "'.concat(s.name,"\". Ensure it's a valid Excel/CSV.")),w({variant:"destructive",title:"Parsing Error",description:'Failed to parse "'.concat(s.name,'".')}),f(!1),T(null),A(null)}}else t(null),"user"===E&&(async()=>{C(!0);try{let e=await fetch("/default_schedule.xlsx");if(!e.ok)throw Error("Default schedule not found.");let t=await e.arrayBuffer(),s=_(t,"default_schedule.xlsx");A(s),T("default"),c([]),w({title:"Switched to Default Schedule",description:"User file removed. Default schedule is now active."})}catch(e){A(null),T(null),c([]),w({title:"Info",description:"User file removed. No active schedule."})}finally{C(!1)}})()},F=async e=>{e.preventDefault();let t=null;if(!S){w({variant:"destructive",title:"Error",description:"default"===E&&D?"Default schedule is still loading.":"Please load a schedule file first (default or upload your own)."});return}if(!s.trim()){w({variant:"destructive",title:"Error",description:"Please enter class codes."});return}f(!0),b(null);let a=s.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e),r=[],l=new Set;if(S)for(let e of S)a.includes(e.classCode)&&!l.has(e.classCode)&&(r.push(e),l.add(e.classCode));let n=new Set(o.map(e=>e.id)),i=r.filter(e=>!n.has(e.id));i.length>0?(c(e=>[...e,...i]),t={title:"Search Complete",description:"".concat(i.length," new exam(s) added to your list.")}):t=r.length>0&&0===i.length?{title:"Info",description:"The exam(s) found in this search are already in your list."}:{title:"No New Results",description:"No new exams matching your criteria found in the current schedule. Check class codes and file content (columns: 'M\xe3 lớp', 'T\xean học phần', 'Ng\xe0y thi', etc.)."},f(!1),t&&w(t)},z=e=>{c(t=>t.filter(t=>t.id!==e)),w({title:"Exam Removed",description:"The exam has been removed from your list."})},B=e=>{try{return(0,i.qg)(e,"dd.MM.yyyy",new Date)}catch(e){return new Date(0)}},H=[...o].sort((e,t)=>{let s=B(e.examDate),a=B(t.examDate);return s.getTime()-a.getTime()});return(0,a.jsxs)("div",{className:"container mx-auto flex flex-col items-center py-8 px-4 min-h-screen",children:[(0,a.jsxs)("header",{className:"mb-10 text-center",children:[(0,a.jsx)("h1",{className:"text-4xl sm:text-5xl font-bold text-primary-foreground drop-shadow-sm",children:"Final Exam Hustle"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2 text-lg",children:"Upload your schedule and find your exams!"})]}),(0,a.jsxs)(g,{className:"w-full max-w-xl p-6 sm:p-8 shadow-2xl rounded-xl",children:[(0,a.jsxs)(y,{className:"text-center sm:text-left",children:[(0,a.jsx)(N,{className:"text-2xl font-semibold",children:"Upload Schedule & Enter Classes"}),(0,a.jsx)(v,{children:"Provide your exam schedule (Excel/CSV) and class codes."})]}),(0,a.jsx)(j,{children:(0,a.jsxs)("form",{onSubmit:F,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(p,{htmlFor:"file-upload",className:"flex items-center text-base",children:[(0,a.jsx)(I.A,{className:"mr-2 h-5 w-5 text-primary"}),"Exam Schedule (Excel/CSV)"]}),(0,a.jsx)(x,{id:"file-upload",type:"file",accept:".xlsx,.xls,.csv",onChange:k,className:"file:text-primary file:font-medium hover:file:bg-primary/10"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center pt-1",children:["user"===E&&e?(0,a.jsx)(O.A,{className:"mr-1 h-3 w-3 text-green-500"}):"default"===E?(0,a.jsx)(P.A,{className:"mr-1 h-3 w-3 text-blue-500"}):D?(0,a.jsx)(U.A,{className:"mr-1 h-3 w-3 animate-spin"}):(0,a.jsx)(L.A,{className:"mr-1 h-3 w-3 text-orange-500"}),"user"===E&&e?'Using your uploaded file: "'.concat(e.name,'"'):"default"===E?"Using the default exam schedule.":D?"Loading default schedule...":"No exam schedule loaded. Upload a file or try reloading if default schedule failed."]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(p,{htmlFor:"class-codes",className:"flex items-center text-base",children:[(0,a.jsx)(V.A,{className:"mr-2 h-5 w-5 text-primary"}),"Class Codes (comma-separated)"]}),(0,a.jsx)(x,{id:"class-codes",type:"text",value:s,onChange:e=>d(e.target.value),placeholder:"e.g., 157324, 158785",required:!0,disabled:!S&&!D||u})]}),(0,a.jsx)(m,{type:"submit",className:"w-full text-lg py-3 bg-accent hover:bg-accent/90 text-accent-foreground",disabled:u||!S&&!D||D&&"user"!==E,children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(U.A,{className:"mr-2 h-5 w-5 animate-spin"}),e?"Loading File...":"Searching..."]}):"Add"})]})})]}),h&&(0,a.jsxs)(g,{className:"w-full max-w-xl mt-8 bg-destructive/10 border-destructive text-destructive-foreground p-6 rounded-lg",children:[(0,a.jsxs)(y,{className:"flex flex-row items-center space-x-3 p-0 mb-2",children:[(0,a.jsx)(L.A,{className:"h-6 w-6 text-destructive"}),(0,a.jsx)(N,{className:"text-destructive text-xl",children:"An Error Occurred"})]}),(0,a.jsx)(j,{className:"p-0",children:(0,a.jsx)("p",{children:h})})]}),u&&!h&&!e&&(0,a.jsxs)("div",{className:"mt-8 text-center",children:[(0,a.jsx)(U.A,{className:"h-12 w-12 animate-spin text-primary mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-lg text-muted-foreground",children:D&&"user"!==E?"Loading default schedule...":"Processing..."})]}),!u&&0===H.length&&!h&&(0,a.jsxs)(g,{className:"w-full max-w-xl mt-8 p-6 rounded-lg bg-secondary/30",children:[(0,a.jsxs)(y,{className:"flex flex-row items-center space-x-3 p-0 mb-2",children:[(0,a.jsx)(W.A,{className:"h-6 w-6 text-primary"}),(0,a.jsx)(N,{className:"text-primary text-xl",children:"No Exams To Display"})]}),(0,a.jsx)(j,{className:"p-0",children:(0,a.jsxs)("p",{className:"text-muted-foreground",children:[E?"No exams found matching your search criteria in the current schedule.":D?"Waiting for default schedule to load or for you to upload a file.":"Upload your exam schedule or try reloading if the default schedule failed to load."," ","Ensure your file has 'M\xe3 lớp', 'T\xean học phần', 'Ng\xe0y thi', etc., or check your search terms."]})})]}),!u&&H.length>0&&(0,a.jsxs)("section",{className:"mt-10 w-full max-w-5xl",children:[(0,a.jsx)("h2",{className:"text-3xl font-semibold mb-6 text-center text-primary-foreground",children:"Your Upcoming Exams"}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:H.map(e=>(0,a.jsx)(M,{exam:e,onDelete:z},e.id))})]})]})}},2383:()=>{},3686:()=>{},7481:(e,t,s)=>{"use strict";s.d(t,{dj:()=>m});var a=s(2115);let r=0,l=new Map,n=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?n(s):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],o={toasts:[]};function c(e){o=i(o,e),d.forEach(e=>{e(o)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:s});return c({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function m(){let[e,t]=a.useState(o);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},8628:(e,t,s)=>{Promise.resolve().then(s.bind(s,510))},9434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(2596),r=s(9688);function l(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[524,202,963,441,684,358],()=>t(8628)),_N_E=e.O()}]);